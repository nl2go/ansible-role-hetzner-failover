---
  scenario:
    test_sequence:
      - lint
      - cleanup
      - destroy
      - dependency
      - syntax
      - create
      - prepare
      - converge
      - idempotence
      - side_effect
      - verify
      - cleanup
      - destroy
  driver:
    name: docker
  lint:
    name: yamllint
  platforms:
    - name: keepalived1
      image: ubuntu:16.04
      dockerfile: ../resources/Dockerfile.j2
      capabilities:
        - NET_ADMIN
      groups:
        - platforms
    - name: keepalived2
      image: ubuntu:16.04
      dockerfile: ../resources/Dockerfile.j2
      capabilities:
        - NET_ADMIN
      groups:
        - platforms
  provisioner:
    name: ansible
    inventory:
      group_vars:
        all:
          hetzner_vswitch_webservice_base_url: http://hetzner-robot:3000
          hetzner_vswitch_webservice_username: robot
          hetzner_vswitch_webservice_password: secret
          hetzner_vswitch_webservice_mock: nl2go/hetzner-robot-api-mock:1.2.3
      host_vars:
        keepalived1:
          hetzner_vswitch_host:
            - name: failover
              ipv4_address: 192.168.200.1
          hetzner_failover_keepalived_state: MASTER
          hetzner_failover_keepalived_vswitch_ip: 192.168.200.1
          hetzner_failover_keepalived_peer_ip: 192.168.200.2
        keepalived2:
          hetzner_vswitch_host:
            - name: failover
              ipv4_address: 192.168.200.2
          hetzner_failover_keepalived_state: BACKUP
          hetzner_failover_keepalived_vswitch_ip: 192.168.200.2
          hetzner_failover_keepalived_peer_ip: 192.168.200.1
    lint:
      name: ansible-lint
    playbooks:
      prepare: ../resources/playbooks/prepare.yml
      cleanup: ../resources/playbooks/cleanup.yml
  verifier:
    name: testinfra
    env:
      HETZNER_ROBOT_BASE_URL: http://hetzner-robot:3000
    lint:
      name: flake8
